<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting Started with the ipd Package ‚Ä¢ ipd</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started with the ipd Package">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ipd</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/ipd.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ipd-tools/ipd/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Getting Started with the ipd Package</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ipd-tools/ipd/blob/master/vignettes/ipd.Rmd" class="external-link"><code>vignettes/ipd.Rmd</code></a></small>
      <div class="d-none name"><code>ipd.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<div class="section level3">
<h3 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h3>
<p>With the rapid advancement of artificial intelligence and machine
learning (AI/ML), researchers from a wide range of disciplines
increasingly use predictions from pre-trained algorithms as outcome
variables in statistical analyses. However, reifying
algorithmically-derived values as measured outcomes may lead to biased
estimates and anti-conservative inference (<a href="https://arxiv.org/abs/2401.08702" class="external-link">Hoffman et al., 2023</a>). The
statistical challenges encountered when drawing inference on predicted
data (IPD) include:</p>
<ol style="list-style-type: decimal">
<li>Understanding the relationship between predicted outcomes and their
true, unobserved counterparts</li>
<li>Quantifying the robustness of the AI/ML models to resampling or
uncertainty about the training data</li>
<li>Appropriately propagating both bias and uncertainty from predictions
into downstream inferential tasks</li>
</ol>
<p>Several works have proposed methods for IPD, including
post-prediction inference (PostPI) by <a href="https://www.pnas.org/doi/suppl/10.1073/pnas.2001238117" class="external-link">Wang et
al., 2020</a>, prediction-powered inference (PPI) and PPI++ by <a href="https://www.science.org/doi/10.1126/science.adi6000" class="external-link">Angelopoulos
et al., 2023a</a> and <a href="https://arxiv.org/abs/2311.01453" class="external-link">Angelopoulos et al., 2023b</a>,
and post-prediction adaptive inference (PSPA) by <a href="https://arxiv.org/abs/2311.14220" class="external-link">Miao et al., 2023</a>. To enable
researchers and practitioners interested in these state-of-the-art
methods, we have developed <code>ipd</code>, a open-source
<code>R</code> package that implements these methods under the umbrella
of IPD.</p>
<p>This vignette provides a guide to using the <code>ipd</code> package,
including installation instructions, examples of data generation, model
fitting, and usage of custom methods. The examples demonstrate the
package‚Äôs functionality.</p>
</div>
<div class="section level3">
<h3 id="notation">Notation<a class="anchor" aria-label="anchor" href="#notation"></a>
</h3>
<p>Following the notation of <a href="https://arxiv.org/abs/2311.14220" class="external-link">Miao et al., 2023</a>, we assume
we have the following data structure:</p>
<ol style="list-style-type: decimal">
<li>We have two datasets: a labeled dataset,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>‚Ñí</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><msup><mi>Y</mi><mi>‚Ñí</mi></msup><mo>,</mo><msup><mi>X</mi><mi>‚Ñí</mi></msup><mo>,</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>X</mi><mi>‚Ñí</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{L} = \left\{Y^\mathcal{L}, X^\mathcal{L}, f\left(X^\mathcal{L}\right)\right\}</annotation></semantics></math>,
and an unlabeled dataset,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">{</mo><msup><mi>X</mi><mi>ùí∞</mi></msup><mo>,</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>X</mi><mi>ùí∞</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\left\{X^\mathcal{U}, f\left(X^\mathcal{U}\right)\right\}</annotation></semantics></math>.
The labeled set is typically smaller in size compared to the unlabeled
set.</li>
<li>We have access to an algorithm
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(X)</annotation></semantics></math>
that can predict our outcome of interest
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>.</li>
<li>Our interest is in performing inference on a quantity such as the
outcome mean or quantile, or to recover a downstream inferential (mean)
model:</li>
</ol>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>Y</mi><mi>ùí∞</mi></msup><mo>‚à£</mo><msup><mi>ùêó</mi><mi>ùí∞</mi></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><msup><mi>g</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>ùêó</mi><mrow><mi>ùí∞</mi><mi>‚Ä≤</mi></mrow></msup><mi>Œ≤</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\mathbb{E}\left[Y^{\mathcal{U}} \mid \boldsymbol{X}^{\mathcal{U}}\right] = g^{-1}\left(\boldsymbol{X}^{\mathcal{U}'}\beta\right),</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ≤</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
is a vector of regression coefficients and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>‚ãÖ</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g(\cdot)</annotation></semantics></math>
is a given link function, such as the identity link for linear
regression, the logistic link for logistic regression, or the log link
for Poisson regression. However, in practice, we do not observe
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Y</mi><mi>ùí∞</mi></msup><annotation encoding="application/x-tex">Y^\mathcal{U}</annotation></semantics></math>
in the ‚Äòunlabeled‚Äô subset of the data. Instead, these values are
replaced by the predicted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>X</mi><mi>ùí∞</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(X^\mathcal{U})</annotation></semantics></math>.
We can use methods for IPD to obtain corrected estimates and standard
errors when we replace these unobserved
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Y</mi><mi>ùí∞</mi></msup><annotation encoding="application/x-tex">Y^\mathcal{U}</annotation></semantics></math>
by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>X</mi><mi>ùí∞</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(X^\mathcal{U})</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>To install the development version of <code>ipd</code> from <a href="https://github.com/ipd-tools/ipd" class="external-link">GitHub</a>, you can use the
<code>devtools</code> package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#-- Install devtools if it is not already installed</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>   </span>
<span></span>
<span><span class="co">#-- Install the ipd package from GitHub</span></span>
<span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"ipd-tools/ipd"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>We provide a simple example to demonstrate the basic use of the
functions included in the <code>ipd</code> package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#-- Load ipd Package</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ipd-tools/ipd" class="external-link">ipd</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="data-generation">Data Generation<a class="anchor" aria-label="anchor" href="#data-generation"></a>
</h3>
<p>The <code>ipd</code> packages provides a unified function,
<code>simdat</code>, for generating synthetic datasets for various
models. The function currently supports ‚Äúmean‚Äù, ‚Äúquantile‚Äù, ‚Äúols‚Äù,
‚Äúlogistic‚Äù, and ‚Äúpoisson‚Äù models.</p>
<div class="section level4">
<h4 id="function-arguments">Function Arguments<a class="anchor" aria-label="anchor" href="#function-arguments"></a>
</h4>
<ul>
<li>
<code>n</code>: A vector of size 3 indicating the sample size in the
training, labeled, and unlabeled data sets.</li>
<li>
<code>effect</code>: A float specifying the regression coefficient
for the first variable of interest (defaults to 1).</li>
<li>
<code>sigma_Y</code>: A float specifying the residual variance for
the generated outcome.</li>
<li>
<code>model</code>: The type of model to be generated. Must be one
of <code>"mean"</code>, <code>"quantile"</code>, <code>"ols"</code>,
<code>"logistic"</code>, or <code>"poisson"</code>.</li>
</ul>
<p>The <code>simdat</code> function generate a data.frame with three
subsets: (1) an independent ‚Äútraining‚Äù set with additional observations
used to fit a prediction model, and ‚Äúlabeled‚Äù and ‚Äúunlabeled‚Äù sets which
contain the observed and predicted outcomes and the simulated features
of interest.</p>
</div>
<div class="section level4">
<h4 id="generating-data-for-linear-regression">Generating Data for Linear Regression<a class="anchor" aria-label="anchor" href="#generating-data-for-linear-regression"></a>
</h4>
<p>We can generate a continuous outcome and relevant predictors for
linear regression as follows. The <code>simdat</code> function generates
four independent covariates,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>2</mn></msub><annotation encoding="application/x-tex">X_2</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>3</mn></msub><annotation encoding="application/x-tex">X_3</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>4</mn></msub><annotation encoding="application/x-tex">X_4</annotation></semantics></math>,
and the outcome:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mtext mathvariant="normal">effect</mtext><mo>√ó</mo><msub><mi>X</mi><mn>1</mn></msub><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>√ó</mo><msubsup><mi>X</mi><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mo>√ó</mo><msubsup><mi>X</mi><mn>3</mn><mn>3</mn></msubsup><mo>+</mo><mfrac><mn>1</mn><mn>4</mn></mfrac><mo>√ó</mo><msubsup><mi>X</mi><mn>4</mn><mn>2</mn></msubsup><mo>+</mo><msub><mi>Œµ</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">Y = \text{effect}\times X_1 + \frac{1}{2}\times X_2^2 + \frac{1}{3}\times X_3^3 + \frac{1}{4}\times X_4^2 + \varepsilon_y</annotation></semantics></math></p>
<p>where <code>effect</code> is one of the function arguments and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œµ</mi><mi>y</mi></msub><mo>‚àº</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mtext mathvariant="normal">sigma_Y</mtext><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\varepsilon_y \sim N(0, \text{sigma_Y})</annotation></semantics></math>,
with <code>sigma_Y</code> being another argument. Here, the
<code>simdat</code> function generates three subsets of data, a
‚Äútraining‚Äù subset, a ‚Äúlabeled‚Äù subset, and an ‚Äúunlabeled‚Äù subset, based
on the sizes in <code>n</code>. It then learns the prediction rule for
the outcome in the ‚Äútraining‚Äù subset using a generalized additive model
and predicts these outcomes in the ‚Äúlabeled‚Äù and ‚Äúunlabeled‚Äù
subsets:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#-- Generate a Dataset for Linear Regression</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">500</span>, <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_ols</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simdat.html">simdat</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, effect <span class="op">=</span> <span class="fl">1</span>, sigma_Y <span class="op">=</span> <span class="fl">4</span>, model <span class="op">=</span> <span class="st">"ols"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#-- Print First 6 Rows of Training, Labeled, and Unlabeled Subsets</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat_ols</span><span class="op">[</span><span class="va">dat_ols</span><span class="op">$</span><span class="va">set_label</span> <span class="op">==</span> <span class="st">"training"</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;       X1    X2    X3     X4     Y  f set_label</span></span>
<span><span class="co">#&gt; 1 -0.560 -0.56  0.82 -0.356 -0.15 NA  training</span></span>
<span><span class="co">#&gt; 2 -0.230  0.13 -1.54  0.040 -4.49 NA  training</span></span>
<span><span class="co">#&gt; 3  1.559  1.82 -0.59  1.152 -1.08 NA  training</span></span>
<span><span class="co">#&gt; 4  0.071  0.16 -0.18  1.485 -3.67 NA  training</span></span>
<span><span class="co">#&gt; 5  0.129 -0.72 -0.71  0.634  2.19 NA  training</span></span>
<span><span class="co">#&gt; 6  1.715  0.58 -0.54 -0.037 -1.42 NA  training</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat_ols</span><span class="op">[</span><span class="va">dat_ols</span><span class="op">$</span><span class="va">set_label</span> <span class="op">==</span> <span class="st">"labeled"</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;          X1      X2    X3    X4     Y     f set_label</span></span>
<span><span class="co">#&gt; 10001  2.37 -1.8984  0.20 -0.17  1.40  3.24   labeled</span></span>
<span><span class="co">#&gt; 10002 -0.17  1.7428  0.26 -2.05  3.56  1.03   labeled</span></span>
<span><span class="co">#&gt; 10003  0.93 -1.0947  0.76  1.25 -3.66  2.37   labeled</span></span>
<span><span class="co">#&gt; 10004 -0.57  0.1757  0.32  0.65 -0.56  0.58   labeled</span></span>
<span><span class="co">#&gt; 10005  0.23  2.0620 -1.35  1.46 -0.82 -0.15   labeled</span></span>
<span><span class="co">#&gt; 10006  1.13 -0.0028  0.23 -0.24  7.30  2.16   labeled</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat_ols</span><span class="op">[</span><span class="va">dat_ols</span><span class="op">$</span><span class="va">set_label</span> <span class="op">==</span> <span class="st">"unlabeled"</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;          X1     X2    X3    X4    Y     f set_label</span></span>
<span><span class="co">#&gt; 10501  0.99 -3.280 -0.39  0.97  8.4  1.25 unlabeled</span></span>
<span><span class="co">#&gt; 10502 -0.66  0.142 -1.36 -0.22 -7.2 -1.08 unlabeled</span></span>
<span><span class="co">#&gt; 10503  0.58 -1.368 -1.73  0.15  5.6 -0.31 unlabeled</span></span>
<span><span class="co">#&gt; 10504 -0.14 -0.728  0.26 -0.23 -4.2  0.91 unlabeled</span></span>
<span><span class="co">#&gt; 10505 -0.17 -0.068 -1.10  0.58  2.2 -0.39 unlabeled</span></span>
<span><span class="co">#&gt; 10506  0.58  0.514 -0.69  0.97 -1.2  0.76 unlabeled</span></span></code></pre></div>
<p>The <code>simdat</code> function provides observed and unobserved
outcomes for both the labeled and unlabeled datasets, though in practice
the observed outcomes are not in the unlabeled set. We can visualize the
relationships between these variables in the labeled data subset:</p>
<p><img src="ipd_files/figure-html/plot-1.png" width="672"></p>
<p>We can see that:</p>
<ul>
<li>The predicted outcomes are more correlated with the covariate than
the true outcomes (plot A)</li>
<li>The predicted outcomes are not perfect substitutes for the true
outcomes (plot B)</li>
</ul>
</div>
<div class="section level4">
<h4 id="generating-data-for-logistic-regression">Generating Data for Logistic Regression<a class="anchor" aria-label="anchor" href="#generating-data-for-logistic-regression"></a>
</h4>
<p>As another example, we can generate a binary outcome and relevant
predictors for logistic regression as follows:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#-- Generate a Dataset for Logistic Regression</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_logistic</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simdat.html">simdat</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, effect <span class="op">=</span> <span class="fl">3</span>, sigma_Y <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                       </span>
<span>  model <span class="op">=</span> <span class="st">"logistic"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#-- Print First 6 Rows of Training, Labeled, and Unlabeled Subsets</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat_logistic</span><span class="op">[</span><span class="va">dat_logistic</span><span class="op">$</span><span class="va">set_label</span> <span class="op">==</span> <span class="st">"training"</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;       X1    X2    X3     X4 Y  f set_label</span></span>
<span><span class="co">#&gt; 1 -0.560 -0.56  0.82 -0.356 1 NA  training</span></span>
<span><span class="co">#&gt; 2 -0.230  0.13 -1.54  0.040 0 NA  training</span></span>
<span><span class="co">#&gt; 3  1.559  1.82 -0.59  1.152 1 NA  training</span></span>
<span><span class="co">#&gt; 4  0.071  0.16 -0.18  1.485 0 NA  training</span></span>
<span><span class="co">#&gt; 5  0.129 -0.72 -0.71  0.634 0 NA  training</span></span>
<span><span class="co">#&gt; 6  1.715  0.58 -0.54 -0.037 1 NA  training</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat_logistic</span><span class="op">[</span><span class="va">dat_logistic</span><span class="op">$</span><span class="va">set_label</span> <span class="op">==</span> <span class="st">"labeled"</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;          X1      X2    X3    X4 Y f set_label</span></span>
<span><span class="co">#&gt; 10001  2.37 -1.8984  0.20 -0.17 1 1   labeled</span></span>
<span><span class="co">#&gt; 10002 -0.17  1.7428  0.26 -2.05 1 1   labeled</span></span>
<span><span class="co">#&gt; 10003  0.93 -1.0947  0.76  1.25 1 1   labeled</span></span>
<span><span class="co">#&gt; 10004 -0.57  0.1757  0.32  0.65 1 0   labeled</span></span>
<span><span class="co">#&gt; 10005  0.23  2.0620 -1.35  1.46 1 1   labeled</span></span>
<span><span class="co">#&gt; 10006  1.13 -0.0028  0.23 -0.24 1 1   labeled</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat_logistic</span><span class="op">[</span><span class="va">dat_logistic</span><span class="op">$</span><span class="va">set_label</span> <span class="op">==</span> <span class="st">"unlabeled"</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;          X1     X2    X3    X4 Y f set_label</span></span>
<span><span class="co">#&gt; 10501  0.99 -3.280 -0.39  0.97 1 1 unlabeled</span></span>
<span><span class="co">#&gt; 10502 -0.66  0.142 -1.36 -0.22 0 0 unlabeled</span></span>
<span><span class="co">#&gt; 10503  0.58 -1.368 -1.73  0.15 1 1 unlabeled</span></span>
<span><span class="co">#&gt; 10504 -0.14 -0.728  0.26 -0.23 0 0 unlabeled</span></span>
<span><span class="co">#&gt; 10505 -0.17 -0.068 -1.10  0.58 1 0 unlabeled</span></span>
<span><span class="co">#&gt; 10506  0.58  0.514 -0.69  0.97 1 1 unlabeled</span></span></code></pre></div>
<p>We can again visualize the relationships between the true and
predicted outcome variables in the labeled data subset and see that
81.8% observations are correctly predicted:</p>
<p><img src="ipd_files/figure-html/plot2-1.png" width="672"></p>
</div>
</div>
<div class="section level3">
<h3 id="model-fitting">Model Fitting<a class="anchor" aria-label="anchor" href="#model-fitting"></a>
</h3>
<div class="section level4">
<h4 id="linear-regression">Linear Regression<a class="anchor" aria-label="anchor" href="#linear-regression"></a>
</h4>
<p>We compare two non-IPD approaches to analyzing the data to methods
included in the <code>ipd</code> package.</p>
<div class="section level5">
<h5 id="naive-regression-using-the-predicted-outcomes">0.1 ‚ÄòNaive‚Äô Regression Using the Predicted Outcomes<a class="anchor" aria-label="anchor" href="#naive-regression-using-the-predicted-outcomes"></a>
</h5>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- Fit the Naive Regression</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">f</span> <span class="op">~</span> <span class="va">X1</span>, data <span class="op">=</span> <span class="va">dat_ols</span><span class="op">[</span><span class="va">dat_ols</span><span class="op">$</span><span class="va">set_label</span> <span class="op">==</span> <span class="st">"unlabeled"</span>,<span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = f ~ X1, data = dat_ols[dat_ols$set_label == "unlabeled", </span></span>
<span><span class="co">#&gt;     ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -2.5426 -0.6138 -0.0153  0.6345  2.8907 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   0.8391     0.0297    28.3   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; X1            0.9848     0.0296    33.3   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.94 on 998 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.527,  Adjusted R-squared:  0.526 </span></span>
<span><span class="co">#&gt; F-statistic: 1.11e+03 on 1 and 998 DF,  p-value: &lt;2e-16</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="classic-regression-using-only-the-labeled-data">0.2 ‚ÄòClassic‚Äô Regression Using only the Labeled Data<a class="anchor" aria-label="anchor" href="#classic-regression-using-only-the-labeled-data"></a>
</h5>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- Fit the Classic Regression</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span>, data <span class="op">=</span> <span class="va">dat_ols</span><span class="op">[</span><span class="va">dat_ols</span><span class="op">$</span><span class="va">set_label</span> <span class="op">==</span> <span class="st">"labeled"</span>,<span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y ~ X1, data = dat_ols[dat_ols$set_label == "labeled", </span></span>
<span><span class="co">#&gt;     ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -15.262  -2.828  -0.094   2.821  11.685 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)    0.908      0.187    4.86  1.6e-06 ***</span></span>
<span><span class="co">#&gt; X1             1.097      0.192    5.71  1.9e-08 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 4.2 on 498 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.0614, Adjusted R-squared:  0.0596 </span></span>
<span><span class="co">#&gt; F-statistic: 32.6 on 1 and 498 DF,  p-value: 1.95e-08</span></span></code></pre></div>
<p>You can fit the various IPD methods to your data and obtain summaries
using the provided wrapper function, <code><a href="../reference/ipd.html">ipd()</a></code>:</p>
</div>
<div class="section level5">
<h5 id="postpi-bootstrap-correction-wang-et-al--2020">1.1 PostPI Bootstrap Correction (Wang et al., 2020)<a class="anchor" aria-label="anchor" href="#postpi-bootstrap-correction-wang-et-al--2020"></a>
</h5>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#-- Specify the Formula</span></span>
<span></span>
<span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="va">Y</span> <span class="op">-</span> <span class="va">f</span> <span class="op">~</span> <span class="va">X1</span></span>
<span></span>
<span><span class="co">#-- Fit the PostPI Bootstrap Correction</span></span>
<span></span>
<span><span class="va">nboot</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span></span>
<span><span class="fu">ipd</span><span class="fu">::</span><span class="fu"><a href="../reference/ipd.html">ipd</a></span><span class="op">(</span><span class="va">formula</span>, </span>
<span>         </span>
<span>  method <span class="op">=</span> <span class="st">"postpi_boot"</span>, model <span class="op">=</span> <span class="st">"ols"</span>, data <span class="op">=</span> <span class="va">dat_ols</span>, label <span class="op">=</span> <span class="st">"set_label"</span>, </span>
<span>  </span>
<span>  nboot <span class="op">=</span> <span class="va">nboot</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt;  Y - f ~ X1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: postpi_boot </span></span>
<span><span class="co">#&gt; Model: ols </span></span>
<span><span class="co">#&gt; Intercept: Yes </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std.Error Lower.CI Upper.CI</span></span>
<span><span class="co">#&gt; (Intercept)    0.873     0.183    0.514     1.23</span></span>
<span><span class="co">#&gt; X1             1.151     0.183    0.793     1.51</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="postpi-analytic-correction-wang-et-al--2020">1.2 PostPI Analytic Correction (Wang et al., 2020)<a class="anchor" aria-label="anchor" href="#postpi-analytic-correction-wang-et-al--2020"></a>
</h5>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#-- Fit the PostPI Analytic Correction</span></span>
<span></span>
<span><span class="fu">ipd</span><span class="fu">::</span><span class="fu"><a href="../reference/ipd.html">ipd</a></span><span class="op">(</span><span class="va">formula</span>, </span>
<span>         </span>
<span>  method <span class="op">=</span> <span class="st">"postpi_analytic"</span>, model <span class="op">=</span> <span class="st">"ols"</span>, data <span class="op">=</span> <span class="va">dat_ols</span>, label <span class="op">=</span> <span class="st">"set_label"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt;  Y - f ~ X1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: postpi_analytic </span></span>
<span><span class="co">#&gt; Model: ols </span></span>
<span><span class="co">#&gt; Intercept: Yes </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std.Error Lower.CI Upper.CI</span></span>
<span><span class="co">#&gt; (Intercept)    0.865     0.183    0.505     1.22</span></span>
<span><span class="co">#&gt; X1             1.145     0.182    0.788     1.50</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="prediction-powered-inference-ppi-angelopoulos-et-al--2023">2. Prediction-Powered Inference (PPI; Angelopoulos et al.,
2023)<a class="anchor" aria-label="anchor" href="#prediction-powered-inference-ppi-angelopoulos-et-al--2023"></a>
</h5>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#-- Fit the PPI Correction</span></span>
<span></span>
<span><span class="fu">ipd</span><span class="fu">::</span><span class="fu"><a href="../reference/ipd.html">ipd</a></span><span class="op">(</span><span class="va">formula</span>, </span>
<span>         </span>
<span>  method <span class="op">=</span> <span class="st">"ppi"</span>, model <span class="op">=</span> <span class="st">"ols"</span>, data <span class="op">=</span> <span class="va">dat_ols</span>, label <span class="op">=</span> <span class="st">"set_label"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt;  Y - f ~ X1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: ppi </span></span>
<span><span class="co">#&gt; Model: ols </span></span>
<span><span class="co">#&gt; Intercept: Yes </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std.Error Lower.CI Upper.CI</span></span>
<span><span class="co">#&gt; (Intercept)    0.871     0.182    0.514     1.23</span></span>
<span><span class="co">#&gt; X1             1.122     0.195    0.740     1.50</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="ppi-angelopoulos-et-al--2023">3. PPI++ (Angelopoulos et al., 2023)<a class="anchor" aria-label="anchor" href="#ppi-angelopoulos-et-al--2023"></a>
</h5>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#-- Fit the PPI++ Correction</span></span>
<span></span>
<span><span class="fu">ipd</span><span class="fu">::</span><span class="fu"><a href="../reference/ipd.html">ipd</a></span><span class="op">(</span><span class="va">formula</span>, </span>
<span>         </span>
<span>  method <span class="op">=</span> <span class="st">"ppi_plusplus"</span>, model <span class="op">=</span> <span class="st">"ols"</span>, data <span class="op">=</span> <span class="va">dat_ols</span>, label <span class="op">=</span> <span class="st">"set_label"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt;  Y - f ~ X1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: ppi_plusplus </span></span>
<span><span class="co">#&gt; Model: ols </span></span>
<span><span class="co">#&gt; Intercept: Yes </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std.Error Lower.CI Upper.CI</span></span>
<span><span class="co">#&gt; (Intercept)    0.881     0.182    0.524     1.24</span></span>
<span><span class="co">#&gt; X1             1.116     0.187    0.750     1.48</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="post-prediction-adaptive-inference-pspa-miao-et-al--2023">4. post-prediction adaptive inference (PSPA; Miao et al., 2023)<a class="anchor" aria-label="anchor" href="#post-prediction-adaptive-inference-pspa-miao-et-al--2023"></a>
</h5>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#-- Fit the PSPA Correction</span></span>
<span></span>
<span><span class="fu">ipd</span><span class="fu">::</span><span class="fu"><a href="../reference/ipd.html">ipd</a></span><span class="op">(</span><span class="va">formula</span>, </span>
<span>         </span>
<span>  method <span class="op">=</span> <span class="st">"pspa"</span>, model <span class="op">=</span> <span class="st">"ols"</span>, data <span class="op">=</span> <span class="va">dat_ols</span>, label <span class="op">=</span> <span class="st">"set_label"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt;  Y - f ~ X1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: pspa </span></span>
<span><span class="co">#&gt; Model: ols </span></span>
<span><span class="co">#&gt; Intercept: Yes </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std.Error Lower.CI Upper.CI</span></span>
<span><span class="co">#&gt; (Intercept)    0.881     0.182    0.524     1.24</span></span>
<span><span class="co">#&gt; X1             1.109     0.187    0.743     1.47</span></span></code></pre></div>
</div>
</div>
<div class="section level4">
<h4 id="logistic-regression">Logistic Regression<a class="anchor" aria-label="anchor" href="#logistic-regression"></a>
</h4>
<p>We also show how these methods compare for logistic regression.</p>
<div class="section level5">
<h5 id="naive-regression-using-the-predicted-outcomes-1">0.1 ‚ÄòNaive‚Äô Regression Using the Predicted Outcomes<a class="anchor" aria-label="anchor" href="#naive-regression-using-the-predicted-outcomes-1"></a>
</h5>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- Fit the Naive Regression</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">f</span> <span class="op">~</span> <span class="va">X1</span>, family <span class="op">=</span> <span class="va">binomial</span>, </span>
<span>    </span>
<span>  data <span class="op">=</span> <span class="va">dat_logistic</span><span class="op">[</span><span class="va">dat_logistic</span><span class="op">$</span><span class="va">set_label</span> <span class="op">==</span> <span class="st">"unlabeled"</span>,<span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm(formula = f ~ X1, family = binomial, data = dat_logistic[dat_logistic$set_label == </span></span>
<span><span class="co">#&gt;     "unlabeled", ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept)    1.173      0.125    9.36   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; X1             3.832      0.257   14.93   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 1328.13  on 999  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance:  569.36  on 998  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 573.4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 7</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="classic-regression-using-only-the-labeled-data-1">0.2 ‚ÄòClassic‚Äô Regression Using only the Labeled Data<a class="anchor" aria-label="anchor" href="#classic-regression-using-only-the-labeled-data-1"></a>
</h5>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- Fit the Classic Regression</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span>, family <span class="op">=</span> <span class="va">binomial</span>,</span>
<span>   </span>
<span>  data <span class="op">=</span> <span class="va">dat_logistic</span><span class="op">[</span><span class="va">dat_logistic</span><span class="op">$</span><span class="va">set_label</span> <span class="op">==</span> <span class="st">"labeled"</span>,<span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm(formula = Y ~ X1, family = binomial, data = dat_logistic[dat_logistic$set_label == </span></span>
<span><span class="co">#&gt;     "labeled", ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept)    0.677      0.121    5.58  2.5e-08 ***</span></span>
<span><span class="co">#&gt; X1             2.064      0.196   10.56  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 665.99  on 499  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance: 449.44  on 498  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 453.4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 5</span></span></code></pre></div>
<p>You can again fit the various IPD methods to your data and obtain
summaries using the provided wrapper function, <code><a href="../reference/ipd.html">ipd()</a></code>:</p>
</div>
<div class="section level5">
<h5 id="postpi-bootstrap-correction-wang-et-al--2020-1">1. PostPI Bootstrap Correction (Wang et al., 2020)<a class="anchor" aria-label="anchor" href="#postpi-bootstrap-correction-wang-et-al--2020-1"></a>
</h5>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#-- Specify the Formula</span></span>
<span></span>
<span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="va">Y</span> <span class="op">-</span> <span class="va">f</span> <span class="op">~</span> <span class="va">X1</span></span>
<span></span>
<span><span class="co">#-- Fit the PostPI Bootstrap Correction</span></span>
<span></span>
<span><span class="va">nboot</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span></span>
<span><span class="fu">ipd</span><span class="fu">::</span><span class="fu"><a href="../reference/ipd.html">ipd</a></span><span class="op">(</span><span class="va">formula</span>, method <span class="op">=</span> <span class="st">"postpi_boot"</span>, model <span class="op">=</span> <span class="st">"logistic"</span>, </span>
<span>         </span>
<span>  data <span class="op">=</span> <span class="va">dat_logistic</span>, label <span class="op">=</span> <span class="st">"set_label"</span>, nboot <span class="op">=</span> <span class="va">nboot</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt;  Y - f ~ X1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: postpi_boot </span></span>
<span><span class="co">#&gt; Model: logistic </span></span>
<span><span class="co">#&gt; Intercept: Yes </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std.Error Lower.CI Upper.CI</span></span>
<span><span class="co">#&gt; (Intercept)   0.5503    0.0741   0.4052      0.7</span></span>
<span><span class="co">#&gt; X1            1.1252    0.0891   0.9506      1.3</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="prediction-powered-inference-ppi-angelopoulos-et-al--2023-1">2. Prediction-Powered Inference (PPI; Angelopoulos et al.,
2023)<a class="anchor" aria-label="anchor" href="#prediction-powered-inference-ppi-angelopoulos-et-al--2023-1"></a>
</h5>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#-- Fit the PPI Correction</span></span>
<span></span>
<span><span class="fu">ipd</span><span class="fu">::</span><span class="fu"><a href="../reference/ipd.html">ipd</a></span><span class="op">(</span><span class="va">formula</span>, method <span class="op">=</span> <span class="st">"ppi"</span>, model <span class="op">=</span> <span class="st">"logistic"</span>, </span>
<span>         </span>
<span>  data <span class="op">=</span> <span class="va">dat_logistic</span>, label <span class="op">=</span> <span class="st">"set_label"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt;  Y - f ~ X1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: ppi </span></span>
<span><span class="co">#&gt; Model: logistic </span></span>
<span><span class="co">#&gt; Intercept: Yes </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;      Estimate Std.Error Lower.CI Upper.CI</span></span>
<span><span class="co">#&gt; [1,]    0.711     0.162    0.394     1.03</span></span>
<span><span class="co">#&gt; [2,]    2.092     0.214    1.673     2.51</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="ppi-angelopoulos-et-al--2023-1">3. PPI++ (Angelopoulos et al., 2023)<a class="anchor" aria-label="anchor" href="#ppi-angelopoulos-et-al--2023-1"></a>
</h5>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#-- Fit the PPI++ Correction</span></span>
<span></span>
<span><span class="fu">ipd</span><span class="fu">::</span><span class="fu"><a href="../reference/ipd.html">ipd</a></span><span class="op">(</span><span class="va">formula</span>, method <span class="op">=</span> <span class="st">"ppi_plusplus"</span>, model <span class="op">=</span> <span class="st">"logistic"</span>, </span>
<span>         </span>
<span>  data <span class="op">=</span> <span class="va">dat_logistic</span>, label <span class="op">=</span> <span class="st">"set_label"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt;  Y - f ~ X1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: ppi_plusplus </span></span>
<span><span class="co">#&gt; Model: logistic </span></span>
<span><span class="co">#&gt; Intercept: Yes </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;      Estimate Std.Error Lower.CI Upper.CI</span></span>
<span><span class="co">#&gt; [1,]    0.688     0.128    0.438     0.94</span></span>
<span><span class="co">#&gt; [2,]    2.074     0.189    1.702     2.44</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="post-prediction-adaptive-inference-pspa-miao-et-al--2023-1">4. Post-Prediction Adaptive Inference (PSPA; Miao et al., 2023)<a class="anchor" aria-label="anchor" href="#post-prediction-adaptive-inference-pspa-miao-et-al--2023-1"></a>
</h5>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#-- Fit the PSPA Correction</span></span>
<span></span>
<span><span class="fu">ipd</span><span class="fu">::</span><span class="fu"><a href="../reference/ipd.html">ipd</a></span><span class="op">(</span><span class="va">formula</span>, method <span class="op">=</span> <span class="st">"pspa"</span>, model <span class="op">=</span> <span class="st">"logistic"</span>, </span>
<span>         </span>
<span>  data <span class="op">=</span> <span class="va">dat_logistic</span>, label <span class="op">=</span> <span class="st">"set_label"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt;  Y - f ~ X1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: pspa </span></span>
<span><span class="co">#&gt; Model: logistic </span></span>
<span><span class="co">#&gt; Intercept: Yes </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std.Error Lower.CI Upper.CI</span></span>
<span><span class="co">#&gt; (Intercept)    0.684     0.124    0.441     0.93</span></span>
<span><span class="co">#&gt; X1             2.072     0.192    1.695     2.45</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="printing-summarizing-and-tidying">Printing, Summarizing, and Tidying<a class="anchor" aria-label="anchor" href="#printing-summarizing-and-tidying"></a>
</h3>
<p>The package also provides custom <code>print</code>,
<code>summary</code>, <code>tidy</code>, <code>glance</code>, and
<code>augment</code> methods to facilitate easy model inspection:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#-- Fit the PostPI Bootstrap Correction</span></span>
<span></span>
<span><span class="va">nboot</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span></span>
<span><span class="va">fit_postpi</span> <span class="op">&lt;-</span> <span class="fu">ipd</span><span class="fu">::</span><span class="fu"><a href="../reference/ipd.html">ipd</a></span><span class="op">(</span><span class="va">formula</span>, </span>
<span>         </span>
<span>  method <span class="op">=</span> <span class="st">"postpi_boot"</span>, model <span class="op">=</span> <span class="st">"ols"</span>, data <span class="op">=</span> <span class="va">dat_ols</span>, label <span class="op">=</span> <span class="st">"set_label"</span>, </span>
<span>  </span>
<span>  nboot <span class="op">=</span> <span class="va">nboot</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="print-method">Print Method<a class="anchor" aria-label="anchor" href="#print-method"></a>
</h4>
<p>The <code>print</code> method gives an abbreviated summary of the
output from the <code>ipd</code> function:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#-- Print the Model</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit_postpi</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt;  Y - f ~ X1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)          X1 </span></span>
<span><span class="co">#&gt;        0.87        1.15</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="summary-method">Summary Method<a class="anchor" aria-label="anchor" href="#summary-method"></a>
</h4>
<p>The <code>summary</code> method gives more detailed information about
the estimated coefficients, standard errors, and confidence limits:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#-- Summarize the Model</span></span>
<span></span>
<span><span class="va">summ_fit_postpi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_postpi</span><span class="op">)</span></span>
<span>  </span>
<span><span class="co">#-- Print the Model Summary</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">summ_fit_postpi</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt;  Y - f ~ X1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: postpi_boot </span></span>
<span><span class="co">#&gt; Model: ols </span></span>
<span><span class="co">#&gt; Intercept: Yes </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std.Error Lower.CI Upper.CI</span></span>
<span><span class="co">#&gt; (Intercept)    0.867     0.183    0.508     1.23</span></span>
<span><span class="co">#&gt; X1             1.154     0.183    0.796     1.51</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="tidy-method">Tidy Method<a class="anchor" aria-label="anchor" href="#tidy-method"></a>
</h4>
<p>The <code>tidy</code> method organizes the model coefficients into a
<a href="https://broom.tidymodels.org/" class="external-link">tidy</a> format.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#-- Tidy the Model Output</span></span>
<span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">fit_postpi</span><span class="op">)</span></span>
<span><span class="co">#&gt;                    term estimate std.error conf.low conf.high</span></span>
<span><span class="co">#&gt; (Intercept) (Intercept)     0.87      0.18     0.51       1.2</span></span>
<span><span class="co">#&gt; X1                   X1     1.15      0.18     0.80       1.5</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="glance-method">Glance Method<a class="anchor" aria-label="anchor" href="#glance-method"></a>
</h4>
<p>The <code>glance</code> method returns a one-row summary of the model
fit.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#-- Get a One-Row Summary of the Model</span></span>
<span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance</a></span><span class="op">(</span><span class="va">fit_postpi</span><span class="op">)</span></span>
<span><span class="co">#&gt;        method model include_intercept nobs_labeled nobs_unlabeled       call</span></span>
<span><span class="co">#&gt; 1 postpi_boot   ols              TRUE          500           1000 Y - f ~ X1</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="augment-method">Augment Method<a class="anchor" aria-label="anchor" href="#augment-method"></a>
</h4>
<p>The <code>augment</code> method adds model predictions and residuals
to the original dataset.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#-- Augment the Original Data with Fitted Values and Residuals</span></span>
<span></span>
<span><span class="va">augmented_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="va">fit_postpi</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">augmented_df</span><span class="op">)</span></span>
<span><span class="co">#&gt;          X1     X2    X3    X4    Y     f set_label .fitted .resid</span></span>
<span><span class="co">#&gt; 10501  0.99 -3.280 -0.39  0.97  8.4  1.25 unlabeled    2.00    6.4</span></span>
<span><span class="co">#&gt; 10502 -0.66  0.142 -1.36 -0.22 -7.2 -1.08 unlabeled    0.10   -7.3</span></span>
<span><span class="co">#&gt; 10503  0.58 -1.368 -1.73  0.15  5.6 -0.31 unlabeled    1.53    4.1</span></span>
<span><span class="co">#&gt; 10504 -0.14 -0.728  0.26 -0.23 -4.2  0.91 unlabeled    0.71   -4.9</span></span>
<span><span class="co">#&gt; 10505 -0.17 -0.068 -1.10  0.58  2.2 -0.39 unlabeled    0.67    1.5</span></span>
<span><span class="co">#&gt; 10506  0.58  0.514 -0.69  0.97 -1.2  0.76 unlabeled    1.53   -2.7</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="conclusions">Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h2>
<p>The <code>ipd</code> package offers a suite of functions for
conducting inference on predicted data. With custom methods for
printing, summarizing, tidying, glancing, and augmenting model outputs,
<code>ipd</code> streamlines the process of IPD-based inference in
<code>R</code>. We will continue to develop this package to include more
targets of inference and IPD methods as they are developed, as well as
additional functionality for analyzing such data. For further
information and detailed documentation, please refer to the function
help pages within the package, e.g.,</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">ipd</span></span></code></pre></div>
<div class="section level3">
<h3 id="feedback">Feedback<a class="anchor" aria-label="anchor" href="#feedback"></a>
</h3>
<p>For questions, comments, or any other feedback, please contact the
developers (<a href="mailto:ssalerno@fredhutch.org" class="email">ssalerno@fredhutch.org</a>).</p>
</div>
<div class="section level3">
<h3 id="contributing">Contributing<a class="anchor" aria-label="anchor" href="#contributing"></a>
</h3>
<p>Contributions are welcome! Please open an issue or submit a pull
request on <a href="https://github.com/ipd-tools/ipd" class="external-link">GitHub</a>.</p>
</div>
<div class="section level3">
<h3 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h3>
<p>This package is licensed under the MIT License.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stephen Salerno, Jiacheng Miao, Awan Afiaz, Kentaro Hoffman, Anna Neufeld, Qiongshi Lu, Tyler H McCormick, Jeffrey T Leek.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
