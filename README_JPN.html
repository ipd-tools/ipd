<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>ipd: Inference on Predicted Data • ipd</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="ipd: Inference on Predicted Data"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">ipd</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="articles/ipd.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ipd-tools/ipd/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>ipd: Inference on Predicted Data</h1>
      <small class="dont-index">Source: <a href="https://github.com/ipd-tools/ipd/blob/master/README_JPN.md" class="external-link"><code>README_JPN.md</code></a></small>
    </div>


<p><a href="https://github.com/ipd-tools/ipd/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/ipd-tools/ipd/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></p>
<!-- badges: end -->
<div class="section level2">
<h2 id="section"><img src="reference/figures/ipd.png" align="right" height="200" style="float:right; height:200px;"><a class="anchor" aria-label="anchor" href="#section"></a></h2>
<div class="section level3">
<h3 id="概要">概要<a class="anchor" aria-label="anchor" href="#%E6%A6%82%E8%A6%81"></a></h3>
</div>
</div>
<div id="ipd-inference-on-predicted-data" class="section level1">

<p>ipdは、人工知能（AI）や機械学習（ML）によって予測されたデータを用いた統計的推論（Inference on Predicted Data: IPD）を支援する、オープンソースのRパッケージです。</p>
<p>現代の多くの応用分野では、ラベル付きデータ（結果が観測されているデータ）が限られており、代わりにAIモデルが予測したラベルを使用して解析を行う場面が増えています。ipdパッケージは、こうした「予測された結果（outcomes）」を使って、共変量（説明変数）と結果の関係を推定する際に生じるバイアスや不確実性を適切に考慮した推論を可能にします。</p>
<p>本パッケージでは、最近提案された複数の手法（PostPI、PPI、PSPAなど）を、共通のインターフェースを通じて簡単に使えるように統合しています。また、print、summary、tidy、glance、augmentといったモデル出力の整形や確認に便利なメソッドも提供しています。</p>
<div class="section level3">
<h3 id="背景">背景<a class="anchor" aria-label="anchor" href="#%E8%83%8C%E6%99%AF"></a></h3>
<p>AIや機械学習モデルによる予測結果は、近年さまざまな分野で活用が進んでいます。特に、医療や社会科学、自然科学などでは、ラベル付きデータの収集が高コストまたは困難であるため、AIが予測した結果をそのまま下流の統計解析に利用するケースが増えています。</p>
<p>しかし、このような予測値を本来の「観測値」の代わりに使うことで、以下のような統計的な問題が生じる可能性があります：</p>
<p>予測値と真の値のズレ：予測された結果（たとえば疾患の有無や治療効果）は、実際に観測されたデータとは異なる性質を持ちます。このズレを考慮しないと、推定に偏りが生じます。 不確実性の過小評価：予測には必ず誤差が含まれますが、それを無視して推論を行うと、標準誤差が小さく見積もられ、信頼区間や仮説検定が正しく機能しません。 AIモデル自体のバイアス：予測に使われるAI/MLモデルが訓練されたデータや手法によっては、特定のサンプルに偏った結果を出すことがあり、そのバイアスが下流の解析結果に影響します。 こうした問題に対処するため、近年さまざまな方法論が提案されてきました。たとえば：</p>
<p>PostPI（予測後推論；Wang et al., 2020）：予測された結果と実際の結果の差を補正する方法 PPI / PPI++（予測駆動推論；Angelopoulos et al., 2023）：予測モデルを再利用して不確実性を伝搬させる手法 PSPA（予測後適応推論；Miao et al., 2023）：データの構造と予測精度を利用して適応的に推論を行う方法 これらの手法は共通して、観測されていない結果をAIで補完したうえで、信頼できる統計的結論を導くことを目的としています。</p>
<figure><img src="reference/figures/ipd_overview.png" alt="Overview of data and setup for IPD"><figcaption aria-hidden="true">
Overview of data and setup for IPD
</figcaption></figure><p>ラベルなしデータの特徴量と予測結果を活用して、ラベル付きデータを補完することで、IPD手法を用いて補正された推定値と標準誤差を得ることができます。</p>
<p>こうした最先端の手法に関心のある研究者や実務者が簡単に利用できるよう、私たちはそれらをIPDという枠組みのもとで実装したRパッケージipdを開発しました。本READMEでは、本パッケージの概要、インストール方法、基本的な使用例、および詳細なドキュメントへのリンクを紹介しています。使用例では、データの生成、モデルの適合、そしてパッケージが提供するカスタムメソッドの使い方を説明しています。</p>
<p>##インストール方法</p>
<p>GitHubからipdの開発版をインストールするには、devtoolsパッケージを使用してください。</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="co">#-- devtoolsがインストールされていない場合はインストール</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>   </span>
<span></span>
<span>    <span class="co">#-- GitHubからipdパッケージをインストール</span></span>
<span></span>
<span>    <span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"ipd-tools/ipd"</span><span class="op">)</span></span></code></pre></div>
<p>##使用方法</p>
<p>ipdパッケージに含まれるメソッドの使い方を示すシンプルな例を紹介します。</p>
<p>###データの生成 simdat関数を使えば、各種回帰モデルに対応した合成データを生成できます。データセットのサイズ、効果量、残差分散、そしてモデルの種類を指定することで、自由にデータを作成できます。現在サポートされているモデルの種類は、「mean（平均）」「quantile（分位数）」「ols（線形回帰）」「logistic（ロジスティック回帰）」「poisson（ポアソン回帰）」です。</p>
<p>simdat関数は、次の3種類のサブセットを含むdata.frameを生成します：</p>
<p>予測モデルの学習に使用される追加の観測値を含む独立した「training（訓練）」セット 観測された結果と予測された結果を含む「labeled（ラベル付き）」セット 同じく観測された結果と予測値、および特徴量を含む「unlabeled（ラベルなし）」セット</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#– ipdライブラリを読み込む</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ipd-tools/ipd" class="external-link">ipd</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">#– 線形回帰用のサンプルデータを生成</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">500</span>, <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simdat.html">simdat</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, effect <span class="op">=</span> <span class="fl">1</span>, sigma_Y <span class="op">=</span> <span class="fl">4</span>, model <span class="op">=</span> <span class="st">'ols'</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#– 訓練、ラベル付き、ラベルなしサブセットの最初の6行を表示</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">set_label</span> <span class="op">==</span> <span class="st">'training'</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;       X1    X2    X3     X4     Y  f set_label</span></span>
<span><span class="co">#&gt; 1 -0.560 -0.56  0.82 -0.356 -0.15 NA  training</span></span>
<span><span class="co">#&gt; 2 -0.230  0.13 -1.54  0.040 -4.49 NA  training</span></span>
<span><span class="co">#&gt; 3  1.559  1.82 -0.59  1.152 -1.08 NA  training</span></span>
<span><span class="co">#&gt; 4  0.071  0.16 -0.18  1.485 -3.67 NA  training</span></span>
<span><span class="co">#&gt; 5  0.129 -0.72 -0.71  0.634  2.19 NA  training</span></span>
<span><span class="co">#&gt; 6  1.715  0.58 -0.54 -0.037 -1.42 NA  training</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">set_label</span> <span class="op">==</span> <span class="st">'labeled'</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;          X1      X2    X3    X4     Y     f set_label</span></span>
<span><span class="co">#&gt; 10001  2.37 -1.8984  0.20 -0.17  1.40  3.24   labeled</span></span>
<span><span class="co">#&gt; 10002 -0.17  1.7428  0.26 -2.05  3.56  1.03   labeled</span></span>
<span><span class="co">#&gt; 10003  0.93 -1.0947  0.76  1.25 -3.66  2.37   labeled</span></span>
<span><span class="co">#&gt; 10004 -0.57  0.1757  0.32  0.65 -0.56  0.58   labeled</span></span>
<span><span class="co">#&gt; 10005  0.23  2.0620 -1.35  1.46 -0.82 -0.15   labeled</span></span>
<span><span class="co">#&gt; 10006  1.13 -0.0028  0.23 -0.24  7.30  2.16   labeled</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">set_label</span> <span class="op">==</span> <span class="st">'unlabeled'</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;          X1     X2    X3    X4    Y     f set_label</span></span>
<span><span class="co">#&gt; 10501  0.99 -3.280 -0.39  0.97  8.4  1.25 unlabeled</span></span>
<span><span class="co">#&gt; 10502 -0.66  0.142 -1.36 -0.22 -7.2 -1.08 unlabeled</span></span>
<span><span class="co">#&gt; 10503  0.58 -1.368 -1.73  0.15  5.6 -0.31 unlabeled</span></span>
<span><span class="co">#&gt; 10504 -0.14 -0.728  0.26 -0.23 -4.2  0.91 unlabeled</span></span>
<span><span class="co">#&gt; 10505 -0.17 -0.068 -1.10  0.58  2.2 -0.39 unlabeled</span></span>
<span><span class="co">#&gt; 10506  0.58  0.514 -0.69  0.97 -1.2  0.76 unlabeled</span></span></code></pre></div>
<p><code>simdat</code>関数は、ラベル付きとラベルなしの両方のデータセットに対して、観測された結果と観測されていない結果を提供しますが、実際にはラベルなしセットには観測された結果はありません。これらの変数間の関係を視覚化できます：</p>
<p><img src="reference/figures/README-plot-1.png" width="100%"></p>
<p>グラフからは次のような傾向が読み取れます：</p>
<p>-プロットA：予測値は実測値よりも共変量との相関が高くなる傾向があります。</p>
<p>-プロットB：予測値は実測値と異なる分布を持つ。</p>
</div>
<div class="section level3">
<h3 id="モデルの適合">モデルの適合<a class="anchor" aria-label="anchor" href="#%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E9%81%A9%E5%90%88"></a></h3>
<p>データを分析するための2つの非IPDアプローチと<code>ipd</code>パッケージに含まれる手法を比較します。以下の表に比較概要表を示し、その後に各手法の具体的な呼び出し方法を示します：</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co">#&gt;                            Estimate Std.Error</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt; ナイーブ                       0.98      0.03</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; クラシック                     1.10      0.19</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; PostPI\n(ブートストラップ)     1.16      0.18</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; PostPI (解析的)                1.15      0.18</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; PPI++                          1.12      0.19</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; PSPA                           1.12      0.19</span></span></code></pre></div>
<p>IPD手法では、推定値や標準誤差は概ね一致しますが、ナイーブ手法では推定値が異なり、標準誤差も過小評価される傾向があります。</p>
<div class="section level4">
<h4 id="id_01-予測された結果を使用したナイーブ回帰">0.1 予測された結果を使用した「ナイーブ」回帰<a class="anchor" aria-label="anchor" href="#id_01-%E4%BA%88%E6%B8%AC%E3%81%95%E3%82%8C%E3%81%9F%E7%B5%90%E6%9E%9C%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9F%E3%83%8A%E3%82%A4%E3%83%BC%E3%83%96%E5%9B%9E%E5%B8%B0"></a></h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="co">#--- ナイーブ回帰を適合</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">f</span> <span class="op">~</span> <span class="va">X1</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">set_label</span> <span class="op">==</span> <span class="st">"unlabeled"</span>,<span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = f ~ X1, data = dat[dat$set_label == "unlabeled", </span></span>
<span><span class="co">#&gt;     ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -2.5426 -0.6138 -0.0153  0.6345  2.8907 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   0.8391     0.0297    28.3   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; X1            0.9848     0.0296    33.3   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.94 on 998 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.527,  Adjusted R-squared:  0.526 </span></span>
<span><span class="co">#&gt; F-statistic: 1.11e+03 on 1 and 998 DF,  p-value: &lt;2e-16</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="id_02-ラベル付きデータのみを使用したクラシック回帰">0.2 ラベル付きデータのみを使用した「クラシック」回帰<a class="anchor" aria-label="anchor" href="#id_02-%E3%83%A9%E3%83%99%E3%83%AB%E4%BB%98%E3%81%8D%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E3%81%BF%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9F%E3%82%AF%E3%83%A9%E3%82%B7%E3%83%83%E3%82%AF%E5%9B%9E%E5%B8%B0"></a></h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#— クラシック回帰を適合</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">set_label</span> <span class="op">==</span> <span class="st">'labeled'</span>,<span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y ~ X1, data = dat[dat$set_label == "labeled", ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -15.262  -2.828  -0.094   2.821  11.685 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)    0.908      0.187    4.86  1.6e-06 ***</span></span>
<span><span class="co">#&gt; X1             1.097      0.192    5.71  1.9e-08 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 4.2 on 498 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.0614, Adjusted R-squared:  0.0596 </span></span>
<span><span class="co">#&gt; F-statistic: 32.6 on 1 and 498 DF,  p-value: 1.95e-08</span></span></code></pre></div>
<p>提供されるラッパー関数<code><a href="reference/ipd.html">ipd()</a></code>を使用して、様々なIPD手法をデータに適合させ、要約を取得できます：</p>
</div>
<div class="section level4">
<h4 id="id_11-postpiブートストラップ補正wang-et-al-2020">1.1 PostPIブートストラップ補正（Wang et al., 2020）<a class="anchor" aria-label="anchor" href="#id_11-postpi%E3%83%96%E3%83%BC%E3%83%88%E3%82%B9%E3%83%88%E3%83%A9%E3%83%83%E3%83%97%E8%A3%9C%E6%AD%A3wang-et-al-2020"></a></h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="co">#-- 式を指定</span></span>
<span></span>
<span>    <span class="va">formula</span> <span class="op">&lt;-</span> <span class="va">Y</span> <span class="op">-</span> <span class="va">f</span> <span class="op">~</span> <span class="va">X1</span></span>
<span></span>
<span>    <span class="co">#-- PostPIブートストラップ補正を適合</span></span>
<span></span>
<span>    <span class="va">nboot</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span></span>
<span>    <span class="fu">ipd</span><span class="fu">::</span><span class="fu"><a href="reference/ipd.html">ipd</a></span><span class="op">(</span><span class="va">formula</span>, </span>
<span>             </span>
<span>      method <span class="op">=</span> <span class="st">"postpi_boot"</span>, model <span class="op">=</span> <span class="st">"ols"</span>, data <span class="op">=</span> <span class="va">dat</span>, label <span class="op">=</span> <span class="st">"set_label"</span>, </span>
<span>      </span>
<span>      nboot <span class="op">=</span> <span class="va">nboot</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt;  Y - f ~ X1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: postpi_boot </span></span>
<span><span class="co">#&gt; Model: ols </span></span>
<span><span class="co">#&gt; Intercept: Yes </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std.Error Lower.CI Upper.CI</span></span>
<span><span class="co">#&gt; (Intercept)    0.866     0.183    0.507     1.22</span></span>
<span><span class="co">#&gt; X1             1.164     0.183    0.806     1.52</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="id_12-postpi解析的補正wang-et-al-2020">1.2 PostPI解析的補正（Wang et al., 2020）<a class="anchor" aria-label="anchor" href="#id_12-postpi%E8%A7%A3%E6%9E%90%E7%9A%84%E8%A3%9C%E6%AD%A3wang-et-al-2020"></a></h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#– PostPI解析的補正を適合</span></span>
<span></span>
<span><span class="fu">ipd</span><span class="fu">::</span><span class="fu"><a href="reference/ipd.html">ipd</a></span><span class="op">(</span><span class="va">formula</span>,</span>
<span></span>
<span>method <span class="op">=</span> <span class="st">'postpi_analytic'</span>, model <span class="op">=</span> <span class="st">'ols'</span>, data <span class="op">=</span> <span class="va">dat</span>, label <span class="op">=</span></span>
<span><span class="st">'set_label'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt;  Y - f ~ X1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: postpi_analytic </span></span>
<span><span class="co">#&gt; Model: ols </span></span>
<span><span class="co">#&gt; Intercept: Yes </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std.Error Lower.CI Upper.CI</span></span>
<span><span class="co">#&gt; (Intercept)    0.865     0.183    0.505     1.22</span></span>
<span><span class="co">#&gt; X1             1.145     0.182    0.788     1.50</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="id_2-予測駆動推論ppi-angelopoulos-et-al-2023">2. 予測駆動推論（PPI; Angelopoulos et al., 2023）<a class="anchor" aria-label="anchor" href="#id_2-%E4%BA%88%E6%B8%AC%E9%A7%86%E5%8B%95%E6%8E%A8%E8%AB%96ppi-angelopoulos-et-al-2023"></a></h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="co">#-- PPI補正を適合</span></span>
<span></span>
<span>    <span class="fu">ipd</span><span class="fu">::</span><span class="fu"><a href="reference/ipd.html">ipd</a></span><span class="op">(</span><span class="va">formula</span>, </span>
<span>             </span>
<span>      method <span class="op">=</span> <span class="st">"ppi"</span>, model <span class="op">=</span> <span class="st">"ols"</span>, data <span class="op">=</span> <span class="va">dat</span>, label <span class="op">=</span> <span class="st">"set_label"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt;  Y - f ~ X1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: ppi </span></span>
<span><span class="co">#&gt; Model: ols </span></span>
<span><span class="co">#&gt; Intercept: Yes </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std.Error Lower.CI Upper.CI</span></span>
<span><span class="co">#&gt; (Intercept)    0.871     0.182    0.514     1.23</span></span>
<span><span class="co">#&gt; X1             1.122     0.195    0.740     1.50</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="id_3-ppiangelopoulos-et-al-2023">3. PPI++（Angelopoulos et al., 2023）<a class="anchor" aria-label="anchor" href="#id_3-ppiangelopoulos-et-al-2023"></a></h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#– PPI++補正を適合</span></span>
<span></span>
<span><span class="fu">ipd</span><span class="fu">::</span><span class="fu"><a href="reference/ipd.html">ipd</a></span><span class="op">(</span><span class="va">formula</span>,</span>
<span></span>
<span>method <span class="op">=</span> <span class="st">'ppi_plusplus'</span>, model <span class="op">=</span> <span class="st">'ols'</span>, data <span class="op">=</span> <span class="va">dat</span>, label <span class="op">=</span> <span class="st">'set_label'</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt;  Y - f ~ X1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: ppi_plusplus </span></span>
<span><span class="co">#&gt; Model: ols </span></span>
<span><span class="co">#&gt; Intercept: Yes </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std.Error Lower.CI Upper.CI</span></span>
<span><span class="co">#&gt; (Intercept)    0.881     0.182    0.524     1.24</span></span>
<span><span class="co">#&gt; X1             1.116     0.187    0.750     1.48</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="id_4-予測後適応推論pspa-miao-et-al-2023">4. 予測後適応推論（PSPA; Miao et al., 2023）<a class="anchor" aria-label="anchor" href="#id_4-%E4%BA%88%E6%B8%AC%E5%BE%8C%E9%81%A9%E5%BF%9C%E6%8E%A8%E8%AB%96pspa-miao-et-al-2023"></a></h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="co">#-- PSPA補正を適合</span></span>
<span></span>
<span>    <span class="fu">ipd</span><span class="fu">::</span><span class="fu"><a href="reference/ipd.html">ipd</a></span><span class="op">(</span><span class="va">formula</span>, </span>
<span>             </span>
<span>      method <span class="op">=</span> <span class="st">"pspa"</span>, model <span class="op">=</span> <span class="st">"ols"</span>, data <span class="op">=</span> <span class="va">dat</span>, label <span class="op">=</span> <span class="st">"set_label"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt;  Y - f ~ X1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: pspa </span></span>
<span><span class="co">#&gt; Model: ols </span></span>
<span><span class="co">#&gt; Intercept: Yes </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std.Error Lower.CI Upper.CI</span></span>
<span><span class="co">#&gt; (Intercept)    0.881     0.182    0.524     1.24</span></span>
<span><span class="co">#&gt; X1             1.109     0.187    0.743     1.47</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="出力と整形">出力と整形<a class="anchor" aria-label="anchor" href="#%E5%87%BA%E5%8A%9B%E3%81%A8%E6%95%B4%E5%BD%A2"></a></h3>
<p>モデルの検証を容易にするため、print、summary、tidy、glance、augmentといったカスタムメソッドも利用できます：</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#– PostPIブートストラップ補正を適合</span></span>
<span></span>
<span><span class="va">nboot</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span></span>
<span><span class="va">fit_postpi</span> <span class="op">&lt;-</span> <span class="fu">ipd</span><span class="fu">::</span><span class="fu"><a href="reference/ipd.html">ipd</a></span><span class="op">(</span><span class="va">formula</span>,</span>
<span></span>
<span>method <span class="op">=</span> <span class="st">'postpi_boot'</span>, model <span class="op">=</span> <span class="st">'ols'</span>, data <span class="op">=</span> <span class="va">dat</span>, label <span class="op">=</span> <span class="st">'set_label'</span>,</span>
<span></span>
<span>nboot <span class="op">=</span> <span class="va">nboot</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#– モデルを出力</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit_postpi</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt;  Y - f ~ X1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)          X1 </span></span>
<span><span class="co">#&gt;        0.86        1.15</span></span>
<span></span>
<span><span class="co">#– モデルを要約</span></span>
<span></span>
<span><span class="va">summ_fit_postpi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_postpi</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#– モデル要約を出力</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">summ_fit_postpi</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt;  Y - f ~ X1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: postpi_boot </span></span>
<span><span class="co">#&gt; Model: ols </span></span>
<span><span class="co">#&gt; Intercept: Yes </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std.Error Lower.CI Upper.CI</span></span>
<span><span class="co">#&gt; (Intercept)    0.860     0.183    0.502     1.22</span></span>
<span><span class="co">#&gt; X1             1.148     0.182    0.790     1.50</span></span>
<span></span>
<span><span class="co">#– モデル出力を整形</span></span>
<span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">fit_postpi</span><span class="op">)</span></span>
<span><span class="co">#&gt;                    term estimate std.error conf.low conf.high</span></span>
<span><span class="co">#&gt; (Intercept) (Intercept)     0.86      0.18     0.50       1.2</span></span>
<span><span class="co">#&gt; X1                   X1     1.15      0.18     0.79       1.5</span></span>
<span></span>
<span><span class="co">#– モデルの1行要約を取得</span></span>
<span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance</a></span><span class="op">(</span><span class="va">fit_postpi</span><span class="op">)</span></span>
<span><span class="co">#&gt;        method model include_intercept nobs_labeled nobs_unlabeled       call</span></span>
<span><span class="co">#&gt; 1 postpi_boot   ols              TRUE          500           1000 Y - f ~ X1</span></span>
<span></span>
<span><span class="co">#– 元のデータに適合値と残差を追加</span></span>
<span></span>
<span><span class="va">augmented_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="va">fit_postpi</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">augmented_df</span><span class="op">)</span></span>
<span><span class="co">#&gt;          X1     X2    X3    X4    Y     f set_label .fitted .resid</span></span>
<span><span class="co">#&gt; 10501  0.99 -3.280 -0.39  0.97  8.4  1.25 unlabeled   1.992    6.5</span></span>
<span><span class="co">#&gt; 10502 -0.66  0.142 -1.36 -0.22 -7.2 -1.08 unlabeled   0.099   -7.3</span></span>
<span><span class="co">#&gt; 10503  0.58 -1.368 -1.73  0.15  5.6 -0.31 unlabeled   1.522    4.1</span></span>
<span><span class="co">#&gt; 10504 -0.14 -0.728  0.26 -0.23 -4.2  0.91 unlabeled   0.702   -4.9</span></span>
<span><span class="co">#&gt; 10505 -0.17 -0.068 -1.10  0.58  2.2 -0.39 unlabeled   0.667    1.5</span></span>
<span><span class="co">#&gt; 10506  0.58  0.514 -0.69  0.97 -1.2  0.76 unlabeled   1.521   -2.7</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="ビネット">ビネット<a class="anchor" aria-label="anchor" href="#%E3%83%93%E3%83%8D%E3%83%83%E3%83%88"></a></h2>
<p>さらなる詳細として、パッケージのビネットでより多くのユースケースと例を提供しています：</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"ipd"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="フィードバック">フィードバック<a class="anchor" aria-label="anchor" href="#%E3%83%95%E3%82%A3%E3%83%BC%E3%83%89%E3%83%90%E3%83%83%E3%82%AF"></a></h2>
<p>質問、コメント、その他のフィードバックについては、開発者（<a href="mailto:ssalerno@fredhutch.org" class="email">ssalerno@fredhutch.org</a>）にお問い合わせください。</p>
</div>
<div class="section level2">
<h2 id="貢献">貢献<a class="anchor" aria-label="anchor" href="#%E8%B2%A2%E7%8C%AE"></a></h2>
<p>貢献を歓迎します！<a href="https://github.com/ipd-tools/ipd" class="external-link">GitHub</a>で問題を開くか、プルリクエストを提出してください。現在、以下の手法/モデルの組み合わせが実装されています：</p>
<table class="table"><colgroup><col width="36%"><col width="11%"><col width="11%"><col width="11%"><col width="11%"><col width="11%"><col width="7%"></colgroup><thead><tr class="header"><th>手法</th>
<th>平均推定</th>
<th>分位数推定</th>
<th>線形回帰</th>
<th>ロジスティック回帰</th>
<th>ポアソン回帰</th>
<th>多クラス回帰</th>
</tr></thead><tbody><tr class="odd"><td><a href="https://www.pnas.org/doi/full/10.1073/pnas.2001238117" class="external-link">PostPI</a></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="white_check_mark">✅</span></td>
<td><span class="emoji" data-emoji="white_check_mark">✅</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
</tr><tr class="even"><td><a href="https://www.science.org/doi/10.1126/science.adi6000" class="external-link">PPI</a></td>
<td><span class="emoji" data-emoji="white_check_mark">✅</span></td>
<td><span class="emoji" data-emoji="white_check_mark">✅</span></td>
<td><span class="emoji" data-emoji="white_check_mark">✅</span></td>
<td><span class="emoji" data-emoji="white_check_mark">✅</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
</tr><tr class="odd"><td><a href="https://arxiv.org/abs/2311.01453" class="external-link">PPI++</a></td>
<td><span class="emoji" data-emoji="white_check_mark">✅</span></td>
<td><span class="emoji" data-emoji="white_check_mark">✅</span></td>
<td><span class="emoji" data-emoji="white_check_mark">✅</span></td>
<td><span class="emoji" data-emoji="white_check_mark">✅</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
</tr><tr class="even"><td><a href="https://arxiv.org/abs/2311.14220" class="external-link">PSPA</a></td>
<td><span class="emoji" data-emoji="white_check_mark">✅</span></td>
<td><span class="emoji" data-emoji="white_check_mark">✅</span></td>
<td><span class="emoji" data-emoji="white_check_mark">✅</span></td>
<td><span class="emoji" data-emoji="white_check_mark">✅</span></td>
<td><span class="emoji" data-emoji="white_check_mark">✅</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
</tr><tr class="odd"><td><a href="https://arxiv.org/abs/2405.20039" class="external-link">PSPS</a></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
</tr><tr class="even"><td><a href="https://arxiv.org/abs/2312.06478" class="external-link">PDC</a></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
</tr><tr class="odd"><td><a href="https://www.pnas.org/doi/10.1073/pnas.2322083121" class="external-link">Cross-PPI</a></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
</tr><tr class="even"><td><a href="https://arxiv.org/abs/2405.18379" class="external-link">PPBoot</a></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
</tr><tr class="odd"><td><a href="https://naokiegami.com/paper/dsl.pdf" class="external-link">DSL</a></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
</tr></tbody></table></div>
<div class="section level2">
<h2 id="ライセンス">ライセンス<a class="anchor" aria-label="anchor" href="#%E3%83%A9%E3%82%A4%E3%82%BB%E3%83%B3%E3%82%B9"></a></h2>
<p>このパッケージはMITライセンスの下でライセンスされています。</p>
</div>
</div>


  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stephen Salerno, Jiacheng Miao, Awan Afiaz, Kentaro Hoffman, Jesse Gronsbell, Jianhui Gao, David Cheng, Anna Neufeld, Qiongshi Lu, Tyler H McCormick, Jeffrey T Leek.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

